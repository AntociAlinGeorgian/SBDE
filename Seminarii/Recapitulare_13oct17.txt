-- SA SE AFISEZE ANGAJATII CU SALARIUL MAI MARE DECAT MEDIA TUTUROR SALARIILOR.
SELECT ID_ANGAJAT, NUME, PRENUME, SALARIUL
FROM ANGAJATI
WHERE SALARIUL > ( SELECT AVG(SALARIUL) FROM ANGAJATI );


-- SA SE AFISEZE ANGAJATII CU SALARIUL MAXIM
SELECT ID_ANGAJAT, NUME, PRENUME, SALARIUL
FROM ANGAJATI
WHERE SALARIUL = ( SELECT MAX(SALARIUL) FROM ANGAJATI );


SELECT ID_ANGAJAT, NUME, PRENUME, SALARIUL
FROM ANGAJATI
WHERE SALARIUL >= ALL ( SELECT SALARIUL FROM ANGAJATI );


-- SA SE AFISEZE ANGAJATII CU SALARIUL MAI MARE DECAT MEDIA SALARIILOR DIN DEPARTAMENTUL LOR
SELECT * FROM ANGAJATI A
WHERE SALARIUL > ( SELECT AVG(SALARIUL) FROM ANGAJATI B WHERE A.ID_DEPARTAMENT=B.ID_DEPARTAMENT)

-- SA SE AFISEZE ANGAJATII CU SALARIUL MAXIM DIN FIECARE DEPARTAMENT
SELECT * FROM ANGAJATI A
WHERE SALARIUL > ( SELECT AVG(SALARIUL) FROM ANGAJATI B WHERE A.ID_DEPARTAMENT=B.ID_DEPARTAMENT)

-- SA SE AFISEZE IDUL FIECARUI DEPARTAMENT SI MEDIA SALARIILOR DIN RESPECTIVUL DEPARTAMENT
SELECT ID_DEPARTAMENT, ROUND(AVG(SALARIUL),2)
FROM ANGAJATI 
GROUP BY ID_DEPARTAMENT;


SELECT A.ID_DEPARTAMENT, D.DENUMIRE_DEPARTAMENT,
ROUND(AVG(SALARIUL),2) SALARIU
FROM ANGAJATI A
LEFT JOIN DEPARTAMENTE D ON A.ID_DEPARTAMENT=D.ID_DEPARTAMENT
GROUP BY A.ID_DEPARTAMENT, D.DENUMIRE_DEPARTAMENT
ORDER BY 1;


-- SA SE AFISEZE ID-UL FIECARUI DEPARTAMENT SI MEDIA SALARIILOR DIN RESPECTIVUL DEPARTAMENT ( AFISEAZA SI DEPARTAMENTELE FARA ANGAJATI )
SELECT A.ID_DEPARTAMENT, D.DENUMIRE_DEPARTAMENT,
ROUND(AVG(SALARIUL),2) SALARIU
FROM ANGAJATI A
RIGHT JOIN DEPARTAMENTE D ON A.ID_DEPARTAMENT=D.ID_DEPARTAMENT
GROUP BY A.ID_DEPARTAMENT, D.DENUMIRE_DEPARTAMENT
ORDER BY 1;


-- SA SE AFISEZE ID-UL FIECARUI DEPARTAMENT SI MEDIA SALARIILOR DIN RESPECTIVUL DEPARTAMENT ( AFISEAZA SI DEPARTAMENTELE FARA ANGAJATI SI ANGAJATII FARA DEPARTAMENT)
SELECT A.ID_DEPARTAMENT, D.DENUMIRE_DEPARTAMENT,
ROUND(AVG(SALARIUL),2) SALARIU
FROM ANGAJATI A
FULL JOIN DEPARTAMENTE D ON A.ID_DEPARTAMENT=D.ID_DEPARTAMENT
GROUP BY A.ID_DEPARTAMENT, D.DENUMIRE_DEPARTAMENT
ORDER BY 1;


-- SA SE AFISEZE ID-UL FIECARUI DEPARTAMENT SI MEDIA SALARIILOR DIN DEPARTAMENTELE CU MAI MULT DE 5 ANGAJATI
SELECT A.ID_DEPARTAMENT, D.DENUMIRE_DEPARTAMENT,
ROUND(AVG(SALARIUL),2) SALARIU
FROM ANGAJATI A
FULL JOIN DEPARTAMENTE D ON A.ID_DEPARTAMENT=D.ID_DEPARTAMENT
GROUP BY A.ID_DEPARTAMENT, D.DENUMIRE_DEPARTAMENT
HAVING COUNT(*)>5
ORDER BY 1;


-- SA SE AFISEZE DEPARTAMENTELE CARE AU CEL PUTIN UN ANGAJATI
SELECT DISTINCT D.ID_DEPARTAMENT,D.DENUMIRE_DEPARTAMENT
FROM ANGAJATI A JOIN DEPARTAMENTE D
ON A.ID_DEPARTAMENT=D.ID_DEPARTAMENT
ORDER BY 1;

SELECT D.ID_DEPARTAMENT, D.DENUMIRE_DEPARTAMENT
FROM DEPARTAMENTE D
WHERE D.ID_DEPARTAMENT IN (SELECT A.ID_DEPARTAMENT FROM ANGAJATI A);

SELECT D.ID_DEPARTAMENT, D.DENUMIRE_DEPARTAMENT
FROM DEPARTAMENTE D
WHERE EXISTS (SELECT 1 FROM ANGAJATI A WHERE A.ID_DEPARTAMENT=D.ID_DEPARTAMENT);


-- SA SE AFISEZE DEPARTAMENTELE CARE NU AU ANGAJATI
SELECT D.ID_DEPARTAMENT, D.DENUMIRE_DEPARTAMENT
FROM ANGAJATI A RIGHT JOIN DEPARTAMENTE D
ON A.ID_DEPARTAMENT=D.ID_DEPARTAMENT
WHERE A.ID_ANGAJAT IS NULL
ORDER BY 1;


SELECT D.ID_DEPARTAMENT, D.DENUMIRE_DEPARTAMENT
FROM DEPARTAMENTE D
WHERE D.ID_DEPARTAMENT NOT IN
(SELECT A.ID_DEPARTAMENT FROM ANGAJATI A
WHERE A.ID_DEPARTAMENT IS NOT NULL);


SELECT D.ID_DEPARTAMENT, D.DENUMIRE_DEPARTAMENT
FROM DEPARTAMENTE D
WHERE NOT EXISTS
(SELECT 1 FROM ANGAJATI A
WHERE A.ID_DEPARTAMENT=D.ID_DEPARTAMENT);